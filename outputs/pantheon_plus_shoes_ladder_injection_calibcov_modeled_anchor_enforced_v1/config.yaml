run:
  run_id: pantheon_plus_shoes_ladder_injection_calibcov_modeled_anchor_enforced_v1
  out_base: outputs
  tasks:
    - baseline_fit
    - injection_suite
    - report

anchor:
  H0: 67.4
  Omega_m: 0.315
  Omega_k: 0.0
  rd_Mpc: 147.09

probe:
  name: pantheon_plus_shoes_ladder
  raw_dat_path: data/raw/pantheon_plus_shoes/Pantheon+SH0ES.dat
  raw_cov_path: data/raw/pantheon_plus_shoes/Pantheon+SH0ES_STAT+SYS.cov
  include_calibrators: true
  include_hubble_flow: true
  z_column: zHD
  z_hf_min: 0.023
  z_hf_max: 0.15

model:
  ladder_level: L2
  shared_scale:
    enable: true
    params: [delta_lnH0]
    # Enforce the early-time anchor in the fit so calibrator-only mechanisms are identifiable.
    prior_sigma: 1.0e-4
  mechanisms:
    calibrator_offset: true
    pkmjd_bins:
      enable: true
      edges: [44672.6, 53410.4, 54131.12, 54885.0, 57269.22, 59385.6]
      apply_to: cal
  priors:
    sigma_global_offset_mag: 10.0
    sigma_survey_offset_mag: 0.2
    sigma_calibrator_offset_mag: 0.2
    sigma_pkmjd_bin_offset_mag: 0.2
    sigma_overrides_path: data/processed/external_calibration/pantheon_plus_shoes_sigma_overrides_from_calibcov_v1.json

injection:
  - label: inject_calibrator_offset_recovery
    mechanism: calibrator_offset_mag
    param_of_interest: calibrator_offset_mag
    amplitudes: [-0.20, -0.10, -0.05, 0.0, 0.05, 0.10, 0.20]
    n_mc: 200
    use_diagonal_errors: true
    seed: 123

  - label: inject_idsurvey_5_recovery
    mechanism: idsurvey_offset_mag
    idsurvey: 5
    apply_to: all
    param_of_interest: survey_offset_5
    amplitudes: [-0.05, -0.02, 0.0, 0.02, 0.05]
    n_mc: 200
    use_diagonal_errors: true
    seed: 456

  - label: inject_pkmjd_bin1_recovery
    mechanism: pkmjd_bin_offset_mag
    edges: [44672.6, 53410.4, 54131.12, 54885.0, 57269.22, 59385.6]
    bin: 1
    apply_to: cal
    param_of_interest: pkmjd_bin_offset_1
    amplitudes: [-0.05, -0.02, 0.0, 0.02, 0.05]
    n_mc: 200
    use_diagonal_errors: true
    seed: 789

