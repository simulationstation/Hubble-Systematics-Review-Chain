run:
  run_id: pantheon_plus_shoes_ladder_mechanisms_v1
  out_base: outputs
  tasks:
    - baseline_fit
    - cut_scan
    - correlated_cut_null
    - injection_suite
    - split_fit
    - sbc
    - report

anchor:
  H0: 67.4
  Omega_m: 0.315
  Omega_k: 0.0
  rd_Mpc: 147.09

probe:
  name: pantheon_plus_shoes_ladder
  raw_dat_path: data/raw/pantheon_plus_shoes/Pantheon+SH0ES.dat
  raw_cov_path: data/raw/pantheon_plus_shoes/Pantheon+SH0ES_STAT+SYS.cov
  include_calibrators: true
  include_hubble_flow: true
  z_column: zHD
  z_hf_min: 0.023
  z_hf_max: 0.15

model:
  ladder_level: L4
  shared_scale:
    enable: true
    params: [delta_lnH0]
    prior_sigma: 0.5
  mechanisms:
    calibrator_offset: true
    mwebv_linear: true
    host_mass_step: true
    host_mass_threshold: 10.0
    pkmjd_linear: true
    pkmjd_bins:
      enable: true
      n_bins: 6
      apply_to: all
  priors:
    sigma_global_offset_mag: 10.0
    sigma_survey_offset_mag: 0.2
    sigma_z_spline_mag: 0.2
    sigma_z_spline_d2_mag: 0.2
    sigma_sky_mode_mag: 0.2
    sigma_calibrator_offset_mag: 0.2
    sigma_mwebv_linear_mag: 0.2
    sigma_host_mass_step_mag: 0.2
    sigma_pkmjd_linear_mag: 0.2
    sigma_pkmjd_bin_offset_mag: 0.2

scan:
  cut_var: z_hf_max
  n_cuts: 12
  cut_min: 0.05
  cut_max: 0.15

"null":
  n_mc: 200
  seed: 123
  drift_param: delta_lnH0
  use_diagonal_errors: true

injection:
  - label: calibrator_offset
    seed: 123
    n_mc: 200
    use_diagonal_errors: true
    mechanism: calibrator_offset_mag
    amplitudes: [-0.20, -0.10, 0.0, 0.10, 0.20]
    param_of_interest: delta_lnH0

  - label: dust_mwebv
    seed: 123
    n_mc: 200
    use_diagonal_errors: true
    mechanism: mwebv_linear_mag
    amplitudes: [-0.20, -0.10, 0.0, 0.10, 0.20]
    param_of_interest: delta_lnH0

  - label: host_mass_step
    seed: 123
    n_mc: 200
    use_diagonal_errors: true
    mechanism: host_mass_step_mag
    threshold: 10.0
    amplitudes: [-0.20, -0.10, 0.0, 0.10, 0.20]
    param_of_interest: delta_lnH0

  - label: time_pkmjd
    seed: 123
    n_mc: 200
    use_diagonal_errors: true
    mechanism: pkmjd_linear_mag
    amplitudes: [-0.20, -0.10, 0.0, 0.10, 0.20]
    param_of_interest: delta_lnH0

sbc:
  seed: 123
  n_rep: 256
  use_diagonal_errors: true

split_fit:
  - label: by_survey
    ladder_level: L2
    split_var: idsurvey
    mode: categories
    param: delta_lnH0
    use_diagonal_errors: true

  - label: by_time
    ladder_level: L2
    split_var: pkmjd
    mode: bins
    edges: [44672.6, 53410.4, 54131.12, 54885.0, 57269.22, 59385.6]
    param: delta_lnH0
    use_diagonal_errors: true

  - label: by_dust
    ladder_level: L2
    split_var: mwebv
    mode: bins
    edges: [0.0, 0.02, 0.04, 0.07, 0.12, 0.25]
    param: delta_lnH0
    use_diagonal_errors: true

  - label: by_host_mass
    ladder_level: L2
    split_var: host_logmass
    mode: bins
    edges: [0.0, 9.5, 10.0, 10.5, 13.0]
    param: delta_lnH0
    use_diagonal_errors: true

