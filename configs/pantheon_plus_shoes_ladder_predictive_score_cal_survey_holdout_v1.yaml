run:
  run_id: pantheon_plus_shoes_ladder_predictive_score_cal_survey_holdout_v1
  out_base: outputs
  tasks:
    - predictive_score
    - report

anchor:
  H0: 67.4
  Omega_m: 0.315
  Omega_k: 0.0
  rd_Mpc: 147.09

probe:
  name: pantheon_plus_shoes_ladder
  raw_dat_path: data/raw/pantheon_plus_shoes/Pantheon+SH0ES.dat
  raw_cov_path: data/raw/pantheon_plus_shoes/Pantheon+SH0ES_STAT+SYS.cov
  include_calibrators: true
  include_hubble_flow: true
  z_column: zHD
  z_hf_min: 0.023
  z_hf_max: 0.15

model:
  ladder_level: L2
  priors:
    sigma_global_offset_mag: 10.0
    sigma_survey_offset_mag: 0.2
    sigma_calibrator_offset_mag: 0.2
    sigma_cal_survey_offset_mag: 0.2
    sigma_pkmjd_bin_offset_mag: 0.2

predictive_score:
  mode: group_holdout
  group_var: idsurvey
  min_group_n: 4
  # Hold out calibrators (for each survey) while keeping hubble-flow fixed in TRAIN.
  always_include_calibrators: false
  always_include_hubble_flow: true
  use_diagonal_errors: true
  models:
    - label: L2_baseline
      ladder_level: L2
      model: {}
    - label: L2_plus_cal_offset
      ladder_level: L2
      model:
        mechanisms:
          calibrator_offset: true
    - label: L2_plus_cal_survey_offsets_min4
      ladder_level: L2
      model:
        mechanisms:
          cal_survey_offsets: true
          cal_survey_offsets_min_cal_per_survey: 4
    - label: L2_plus_cal_time_bins
      ladder_level: L2
      model:
        mechanisms:
          pkmjd_bins:
            enable: true
            edges: [44672.6, 53410.4, 54131.12, 54885.0, 57269.22, 59385.6]
            apply_to: cal
